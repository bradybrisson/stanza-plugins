# Plugin Info
version: 0.0.1
title: Vault
description: 'Log parser for Vault Audit Logs.'
parameters:
  - name: file_path
    label: Vault Audit Logs Path
    description: The absolute path to the Vault audit logs
    type: string
    default: "/var/log/vault_audit.log"
  - name: start_at
    label: Start At
    description: Start reading file from 'beginning' or 'end'
    type: enum
    valid_values:
      - beginning
      - end
    default: end

# Set Defaults
# {{$file_path := default "/var/log/vault_audit.log" .file_path}}
# {{$start_at := default "end" .start_at}}

# Pipeline Template
pipeline:
  - type: file_input
    start_at: '{{ $start_at }}'
    include: 
      - '{{ $file_path }}'
    include_file_name: true
    labels:
      plugin_id: {{ .id }}

  - type: json_parser
    output: {{ .output }}
